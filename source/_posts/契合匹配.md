---
title: 契合匹配
date: 2024-07-30 21:20:02
tags: KMP
categories: 蓝桥
---

# 解题思路

我们首先可以做的事是将 $T$ 串大小写转换，那么就变成了两个字符串的完全匹配。

然后，使用破环成链的思想，将 $S$ 串扩大两倍成为 $S'$。

如果一个字符串 $S(abcdef)$ 扩展成两倍 $S'(abcdefabcdef)$，那么从 $S'$ 的第二个字符开始 $6$ 个字符组成的子串 $(bcdefa)$，实际上就是 $S$ 逆时针旋转 $1$ 位的字符串，同时也是顺时针旋转 $5$ 位的情况。

然后，将 $T$ 串与 $S'$ 使用 KMP 算法进行匹配，之后我们考虑匹配到的位置顺时针与逆时针旋转需要的步数，取最优解即可。

$lps[i]$：$t[1\sim i]$ 的最大相同前后缀的长度。有 * 表示 $lps[len]=lps[i]$。

|          | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7   | 8   | 9   | 10  | 11  |
| -------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | --- | --- | --- | --- | --- |
| $t[i]$   | A    | C    | A    | B    | A    | C    | A    | B   | A   | C   | A   | C   |
|          | len  | i    |      |      |      |      |      |     |     |     |     |     |
|          | len* |      | i    |      |      |      |      |     |     |     |     |     |
|          |      | len  |      | i    |      |      |      |     |     |     |     |     |
|          | len  |      |      | i    |      |      |      |     |     |     |     |     |
|          | len* |      |      |      | i    |      |      |     |     |     |     |     |
|          |      | len* |      |      |      | i    |      |     |     |     |     |     |
|          |      |      | len* |      |      |      | i    |     |     |     |     |     |
|          |      |      |      | len* |      |      |      | i   |     |     |     |     |
|          |      |      |      |      | len* |      |      |     | i   |     |     |     |
|          |      |      |      |      |      | len* |      |     |     | i   |     |     |
|          |      |      |      |      |      |      | len* |     |     |     | i   |     |
|          |      |      |      |      |      |      |      | len |     |     |     | i   |
|          |      |      |      | len  |      |      |      |     |     |     |     | i   |
|          |      | len* |      |      |      |      |      |     |     |     |     | i   |
| $lps[i]$ | 0    | 0    | 1    | 0    | 1    | 2    | 3    | 4   | 5   | 6   | 7   | 2   |

# AC_Code

```cpp
#include <bits/stdc++.h>
using namespace std;
//#define int long long
//using ll = long long;
const int N = 2e5 + 10, mod = 1e9 + 7;
void solve() {
    int n; cin >> n;
    string s, t; cin >> s >> t;
    s += s;
    for (auto& e : t) {
        e ^= 0x20;
    }
    bool flag = 0;
    int ans = 1e6;
    vector<int> lps(n);
    for (int i = 1, len = 0; i < n; ) {
        if (t[i] == t[len]) {
            lps[i++] = ++len;
        } else if (len) {
            len = lps[len - 1];
        } else {
            lps[i++] = 0;
        }
    }
    int m = n << 1;
    for (int i = 0, j = 0; i < m; ) {
        if (s[i] == t[j]) {
            i++, j++;
        }
        if (j == n) {
            flag = 1;
            ans = min(ans, min(i - j, n - i + j));
            j = lps[j - 1];
        } else if (i < m && s[i] != t[j]) {
            if (j) {
                j = lps[j - 1];
            } else {
                i++;
            }
        }
    }
    if (flag) {
        cout << "Yes\n" << ans;
    } else {
        cout << "No";
    }
}
signed main() {
    ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);
    //int _; cin >> _; while (_--)
    solve();
    return 0;
}
```